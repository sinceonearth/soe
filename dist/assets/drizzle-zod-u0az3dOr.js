import{u as _,s as m,n as c,b as h,a as X,r as E,c as P,d as g,e as G,o as D,z as x}from"./zod-O7j-j6XA.js";import{g as U,a as C,i as y,b as T,S as f,c as q,C as u}from"./drizzle-orm-Ius2hpm3.js";const s={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:16777215,INT32_MIN:-2147483648,INT32_MAX:2147483647,INT32_UNSIGNED_MAX:4294967295,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-9223372036854775808n,INT64_MAX:9223372036854775807n,INT64_UNSIGNED_MAX:18446744073709551615n};function l(e,N){return N.includes(e.columnType)}function V(e){return"enumValues"in e&&Array.isArray(e.enumValues)&&e.enumValues.length>0}const j=_([m(),c(),h(),X()]),R=_([j,E(g()),P(g())]),B=G(e=>e instanceof Buffer);function M(e,N){const n=N?.zodInstance??x,i=N?.coerce??{};let t;return V(e)&&(t=e.enumValues.length?n.enum(e.enumValues):n.string()),t||(l(e,["PgGeometry","PgPointTuple"])?t=n.tuple([n.number(),n.number()]):l(e,["PgGeometryObject","PgPointObject"])?t=n.object({x:n.number(),y:n.number()}):l(e,["PgHalfVector","PgVector"])?(t=n.array(n.number()),t=e.dimensions?t.length(e.dimensions):t):l(e,["PgLine"])?t=n.tuple([n.number(),n.number(),n.number()]):l(e,["PgLineABC"])?t=n.object({a:n.number(),b:n.number(),c:n.number()}):l(e,["PgArray"])?(t=n.array(M(e.baseColumn,n)),t=e.size?t.length(e.size):t):e.dataType==="array"?t=n.array(n.any()):e.dataType==="number"?t=F(e,n,i):e.dataType==="bigint"?t=L(e,n,i):e.dataType==="boolean"?t=i===!0||i.boolean?n.coerce.boolean():n.boolean():e.dataType==="date"?t=i===!0||i.date?n.coerce.date():n.date():e.dataType==="string"?t=Q(e,n,i):e.dataType==="json"?t=R:e.dataType==="custom"?t=n.any():e.dataType==="buffer"&&(t=B)),t||(t=n.any()),t}function F(e,N,n){let i=e.getSQLType().includes("unsigned"),t,a,r=!1;l(e,["MySqlTinyInt","SingleStoreTinyInt"])?(t=i?0:s.INT8_MIN,a=i?s.INT8_UNSIGNED_MAX:s.INT8_MAX,r=!0):l(e,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(t=i?0:s.INT16_MIN,a=i?s.INT16_UNSIGNED_MAX:s.INT16_MAX,r=!0):l(e,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(t=i?0:s.INT24_MIN,a=i?s.INT24_UNSIGNED_MAX:s.INT24_MAX,r=l(e,["MySqlMediumInt","SingleStoreMediumInt"])):l(e,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(t=i?0:s.INT32_MIN,a=i?s.INT32_UNSIGNED_MAX:s.INT32_MAX,r=!0):l(e,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(t=i?0:s.INT48_MIN,a=i?s.INT48_UNSIGNED_MAX:s.INT48_MAX):l(e,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(i=i||l(e,["MySqlSerial","SingleStoreSerial"]),t=i?0:Number.MIN_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER,r=!0):l(e,["MySqlYear","SingleStoreYear"])?(t=1901,a=2155,r=!0):(t=Number.MIN_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER);let I=n===!0||n?.number?N.coerce.number():N.number();return I=I.min(t).max(a),r?I.int():I}function L(e,N,n){const i=e.getSQLType().includes("unsigned"),t=i?0n:s.INT64_MIN,a=i?s.INT64_UNSIGNED_MAX:s.INT64_MAX;return(n===!0||n?.bigint?N.coerce.bigint():N.bigint()).min(t).max(a)}function Q(e,N,n){if(l(e,["PgUUID"]))return N.string().uuid();let i,t,a=!1;l(e,["PgVarchar","SQLiteText"])?i=e.length:l(e,["MySqlVarChar","SingleStoreVarChar"])?i=e.length??s.INT16_UNSIGNED_MAX:l(e,["MySqlText","SingleStoreText"])&&(e.textType==="longtext"?i=s.INT32_UNSIGNED_MAX:e.textType==="mediumtext"?i=s.INT24_UNSIGNED_MAX:e.textType==="text"?i=s.INT16_UNSIGNED_MAX:i=s.INT8_UNSIGNED_MAX),l(e,["PgChar","MySqlChar","SingleStoreChar"])&&(i=e.length,a=!0),l(e,["PgBinaryVector"])&&(t=/^[01]+$/,i=e.dimensions);let r=n===!0||n?.string?N.coerce.string():N.string();return r=t?r.regex(t):r,i&&a?r.length(i):i?r.max(i):r}function b(e){return y(e)?U(e):C(e)}function d(e,N,n,i){const t={};for(const[a,r]of Object.entries(e)){if(!T(r,u)&&!T(r,f)&&!T(r,f.Aliased)&&typeof r=="object"){const p=y(r)||q(r)?b(r):r;t[a]=d(p,N[a]??{},n,i);continue}const I=N[a];if(I!==void 0&&typeof I!="function"){t[a]=I;continue}const S=T(r,u)?r:void 0,o=S?M(S,i):g(),A=typeof I=="function"?I(o):o;n.never(S)||(t[a]=A,S&&(n.nullable(S)&&(t[a]=t[a].nullable()),n.optional(S)&&(t[a]=t[a].optional())))}return D(t)}const w={never:e=>e?.generated?.type==="always"||e?.generatedIdentity?.type==="always",optional:e=>!e.notNull||e.notNull&&e.hasDefault,nullable:e=>!e.notNull},Y=(e,N)=>{const n=b(e);return d(n,{},w)};export{Y as c};
