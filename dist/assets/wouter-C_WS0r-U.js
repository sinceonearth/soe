import{p as A}from"./regexparam-CPXopyEH.js";import{r as o,a as B}from"./react-BwszucfI.js";import{s as F}from"./use-sync-external-store-DD8l8Lcj.js";const H=B.useInsertionEffect,M=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",N=M?o.useLayoutEffect:o.useEffect,V=H||N,L=e=>{const t=o.useRef([e,(...n)=>t[0](...n)]).current;return V(()=>{t[0]=e}),t[1]},T="popstate",y="pushState",E="replaceState",$="hashchange",b=[T,y,E,$],q=e=>{for(const t of b)addEventListener(t,e);return()=>{for(const t of b)removeEventListener(t,e)}},k=(e,t)=>F.useSyncExternalStore(q,e,t),z=()=>location.search,G=({ssrSearch:e=""}={})=>k(z,()=>e),w=()=>location.pathname,J=({ssrPath:e}={})=>k(w,e?()=>e:w),Q=(e,{replace:t=!1,state:n=null}={})=>history[t?E:y](n,"",e),W=(e={})=>[J(e),Q],R=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[R]>"u"){for(const e of[y,E]){const t=history[e];history[e]=function(){const n=t.apply(this,arguments),s=new Event(e);return s.arguments=arguments,dispatchEvent(s),n}}Object.defineProperty(window,R,{value:!0})}const X=(e,t)=>t.toLowerCase().indexOf(e.toLowerCase())?"~"+t:t.slice(e.length)||"/",S=(e="")=>e==="/"?"":e,Y=(e,t)=>e[0]==="~"?e.slice(1):S(t)+e,Z=(e="",t)=>X(x(S(e)),x(t)),x=e=>{try{return decodeURI(e)}catch{return e}},O={hook:W,searchHook:G,parser:A,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:e=>e},j=o.createContext(O),d=()=>o.useContext(j),_={},I=o.createContext(_),ee=()=>o.useContext(I),p=e=>{const[t,n]=e.hook(e);return[Z(e.base,t),L((s,r)=>n(Y(s,e.base),r))]},ce=()=>p(d()),K=(e,t,n,s)=>{const{pattern:r,keys:i}=t instanceof RegExp?{keys:!1,pattern:t}:e(t||"*",s),u=r.exec(n)||[],[l,...f]=u;return l!==void 0?[!0,(()=>{const a=i!==!1?Object.fromEntries(i.map((m,P)=>[m,f[P]])):u.groups;let c={...f};return a&&Object.assign(c,a),c})(),...s?[l]:[]]:[!1,null]},te=({children:e,...t})=>{const n=d(),s=t.hook?O:n;let r=s;const[i,u]=t.ssrPath?.split("?")??[];u&&(t.ssrSearch=u,t.ssrPath=i),t.hrefs=t.hrefs??t.hook?.hrefs;let l=o.useRef({}),f=l.current,a=f;for(let c in s){const m=c==="base"?s[c]+(t[c]||""):t[c]||s[c];f===a&&m!==a[c]&&(l.current=a={...a}),a[c]=m,(m!==s[c]||m!==r[c])&&(r=a)}return o.createElement(j.Provider,{value:r,children:e})},C=({children:e,component:t},n)=>t?o.createElement(t,{params:n}):typeof e=="function"?e(n):e,ne=e=>{let t=o.useRef(_);const n=t.current;return t.current=Object.keys(e).length!==Object.keys(n).length||Object.entries(e).some(([s,r])=>r!==n[s])?e:n},ae=({path:e,nest:t,match:n,...s})=>{const r=d(),[i]=p(r),[u,l,f]=n??K(r.parser,e,i,t),a=ne({...ee(),...l});if(!u)return null;const c=f?o.createElement(te,{base:f},C(s,a)):C(s,a);return o.createElement(I.Provider,{value:a,children:c})},ue=o.forwardRef((e,t)=>{const n=d(),[s,r]=p(n),{to:i="",href:u=i,onClick:l,asChild:f,children:a,className:c,replace:m,state:P,...U}=e,v=L(h=>{h.ctrlKey||h.metaKey||h.altKey||h.shiftKey||h.button!==0||(l?.(h),h.defaultPrevented||(h.preventDefault(),r(u,e)))}),g=n.hrefs(u[0]==="~"?u.slice(1):n.base+u,n);return f&&o.isValidElement(a)?o.cloneElement(a,{onClick:v,href:g}):o.createElement("a",{...U,onClick:v,href:g,className:c?.call?c(s===u):c,children:a,ref:t})}),D=e=>Array.isArray(e)?e.flatMap(t=>D(t&&t.type===o.Fragment?t.props.children:t)):[e],ie=({children:e,location:t})=>{const n=d(),[s]=p(n);for(const r of D(e)){let i=0;if(o.isValidElement(r)&&(i=K(n.parser,r.props.path,t||s,r.props.nest))[0])return o.cloneElement(r,{match:i})}return null};export{ue as L,ae as R,ie as S,ce as u};
